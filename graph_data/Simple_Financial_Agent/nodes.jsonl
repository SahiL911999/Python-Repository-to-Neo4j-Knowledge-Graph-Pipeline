{"id": "60ec8b3e740b5ee49befd18d30ead4262cea8ea8", "type": "Repository", "name": "Simple_Financial_Agent", "path": "/home/sahil/Workspace/Source Wall/Simple_Financial_Agent"}
{"id": "6b42694153ac904cb7ed7c2a72d51335a2da5e98", "type": "Directory", "name": "__pycache__", "path": "/home/sahil/Workspace/Source Wall/Simple_Financial_Agent/__pycache__", "relpath": "__pycache__"}
{"id": "13878660ae310763d160aa167d43f5b8987bb1b6", "type": "File", "name": "financial_agent.py", "path": "/home/sahil/Workspace/Source Wall/Simple_Financial_Agent/financial_agent.py", "relpath": "financial_agent.py", "module": "financial_agent", "extension": ".py", "sha1": "2a591f96226168072ecec183e1bf248f1b52f057", "lines_of_code": 139, "source_code": "'''\nFinancial Report Automation Agent\n---------------------------------\n\nThis module defines the `FinancialReportAgent` class, an automated system that connects \nto a financial database, computes key performance indicators (KPIs), and generates \ndata-driven analytical reports using a Large Language Model (LLM).\n\nCore Features:\n- Fetches and calculates KPI metrics via `DatabaseManager`\n- Evaluates KPI performance against configurable thresholds (good, warning, critical)\n- Generates comprehensive financial analysis reports with executive summaries, \n  risk assessments, and actionable recommendations\n- Creates a professionally formatted PDF report through `PDFReportGenerator`\n- Integrates with the Groq API for LLM-based report generation\n\nStructure:\n- `get_kpi_status()`: Evaluates individual KPI status based on thresholds\n- `generate_report()`: Produces a detailed text-based financial report using LLM output\n- `generate_pdf_report()`: Combines KPI data and AI-generated analysis into a PDF file\n\nUsage:\n1. Initialize the agent with a configuration YAML path and Groq API key.\n2. Call `generate_pdf_report()` to produce both text and PDF versions of the report.\n\nExample:\n    agent = FinancialReportAgent(\"config.yaml\", \"<GROQ_API_KEY>\")\n    text_report, pdf_path = agent.generate_pdf_report()\n    print(f\"Report saved to: {pdf_path}\")\n'''\n\nimport os\nfrom groq import Groq\nimport yaml\nfrom database_manager import DatabaseManager\nfrom pdf_generator import PDFReportGenerator\nfrom typing import Dict, Any\nfrom datetime import datetime\n\nclass FinancialReportAgent:\n    def __init__(self, config_path: str, groq_api_key: str):\n        self.db_manager = DatabaseManager(config_path)\n        self.client = Groq(api_key=groq_api_key)\n        \n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)\n    \n    def get_kpi_status(self, kpi_name: str, value: float) -> str:\n        kpi_config = self.config['kpis'][kpi_name]\n        target = kpi_config['target']\n        warning = kpi_config['threshold_warning']\n        critical = kpi_config['threshold_critical']\n        \n        if kpi_name in ['on_time_delivery']:  # Higher is better\n            if value >= target:\n                return \"GOOD\"\n            elif value >= warning:\n                return \"WARNING\"\n            else:\n                return \"CRITICAL\"\n        else:  # Lower is better\n            if value <= target:\n                return \"GOOD\"\n            elif value <= warning:\n                return \"WARNING\"\n            else:\n                return \"CRITICAL\"\n    \n    def generate_report(self) -> str:\n        kpis = self.db_manager.calculate_kpis()\n        \n        # Prepare KPI summary\n        kpi_summary = []\n        for kpi_name, value in kpis.items():\n            status = self.get_kpi_status(kpi_name, value)\n            target = self.config['kpis'][kpi_name]['target']\n            description = self.config['kpis'][kpi_name]['description']\n            \n            kpi_summary.append({\n                'name': kpi_name,\n                'value': round(value, 1),\n                'target': target,\n                'status': status,\n                'description': description\n            })\n        \n        # Create prompt for LLM\n        prompt = f\"\"\"\n        You are a financial analyst AI. Generate a comprehensive financial report based on the following Purchase Order KPIs:\n\n        KPI Performance:\n        {chr(10).join([f\"- {kpi['description']}: {kpi['value']} (Target: {kpi['target']}) - Status: {kpi['status']}\" for kpi in kpi_summary])}\n\n        Please provide:\n        1. Executive Summary\n        2. KPI Analysis with insights (use numbered lists, NOT tables)\n        3. Risk Assessment\n        4. Recommendations for improvement\n\n        Format the report professionally with clear sections and actionable insights. Do NOT use markdown tables or pipe symbols.\n        \"\"\"\n        \n        response = self.client.chat.completions.create(\n            messages=[{\"role\": \"user\", \"content\": prompt}],\n            model=\"openai/gpt-oss-20b\",\n            temperature=0.3\n        )\n        \n        return response.choices[0].message.content\n    \n    def generate_pdf_report(self) -> tuple:\n        \"\"\"Generate both text and PDF reports\"\"\"\n        kpis = self.db_manager.calculate_kpis()\n        \n        # Prepare KPI summary\n        kpi_summary = []\n        for kpi_name, value in kpis.items():\n            status = self.get_kpi_status(kpi_name, value)\n            target = self.config['kpis'][kpi_name]['target']\n            description = self.config['kpis'][kpi_name]['description']\n            \n            kpi_summary.append({\n                'name': kpi_name,\n                'value': round(value, 1),\n                'target': target,\n                'status': status,\n                'description': description\n            })\n        \n        # Generate AI report\n        ai_report = self.generate_report()\n        \n        # Generate PDF\n        pdf_generator = PDFReportGenerator()\n        timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n        pdf_filename = f\"{timestamp}_PO_Report.pdf\"\n        pdf_generator.generate_pdf_report(kpi_summary, ai_report, pdf_filename)\n        \n        return ai_report, pdf_filename", "size_bytes": 5254, "language": "python", "encoding": "utf-8", "embedding_semantics": "File: financial_agent.py | Module: financial_agent | Documentation:\nFinancial Report Automation Agent\n---------------------------------\n\nThis module defines the `FinancialReportAgent` class, an automated system that connects \nto a financial database, computes key performance indicators (KPIs), and generates \ndata-driven analytical reports using a Large Language Model (LLM).\n\nCore Features:\n- Fetches and calculates KPI metrics via `DatabaseManager`\n- Evaluates KPI performance against configurable thresholds (good, warning, critical)\n- Generates comprehensive financial analysis reports with executive summaries, \n  risk assessments, and actionable recommendations\n- Creates a professionally formatted PDF report through `PDFReportGenerator`\n- Integrates with the Groq API for LLM-based report generation\n\nStructure:\n- `get_kpi_status()`: Evaluates individual KPI status based on thresholds\n- `generate_report()`: Produces a detailed text-based financial report using LLM output\n- `generate_pdf_report()`: Combines KPI data and AI-generated analysis into a PDF file\n\nUsage:\n1. Initialize the agent with a configuration YAML path and Groq API key.\n2. Call `generate_pdf_report()` to produce both text and PDF versions of the report.\n\nExample:\n    agent = FinancialReportAgent(\"config.yaml\", \"<GROQ_API_KEY>\")\n    text_report, pdf_path = agent.generate_pdf_report()\n    print(f\"Report saved to: {pdf_path}\")"}
{"id": "b96b89e111475536be242332863c5d9aa1009db9", "type": "Import", "name": "os", "alias": null, "import_type": "direct", "lineno": 32, "is_stdlib": true, "is_relative": false, "level": 0, "is_function_level": false, "scope": "module"}
{"id": "b7cd1529638a7d4905c96ca55b7675b493de59da", "type": "Import", "name": "Groq", "module": "groq", "full_name": "groq.Groq", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 33, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "c0dd6e2d467c8e238ea487505c5246aa5770d43f", "type": "Import", "name": "yaml", "alias": null, "import_type": "direct", "lineno": 34, "is_stdlib": false, "is_relative": false, "level": 0, "is_function_level": false, "scope": "module"}
{"id": "056dc98645936e6dbb7bfcd3ada8da50828383ea", "type": "Import", "name": "DatabaseManager", "module": "database_manager", "full_name": "database_manager.DatabaseManager", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 35, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "0ae65c918d0e194120a37777c3ce77d5ace6bedc", "type": "Import", "name": "PDFReportGenerator", "module": "pdf_generator", "full_name": "pdf_generator.PDFReportGenerator", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 36, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "dac621a37cb6942452de2a6ef13c393a7fc7e1d5", "type": "Import", "name": "Dict", "module": "typing", "full_name": "typing.Dict", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 37, "is_stdlib": true, "is_function_level": false, "scope": "module"}
{"id": "ba17216381f6264fcce415ca280d47122aa9f20a", "type": "Import", "name": "Any", "module": "typing", "full_name": "typing.Any", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 37, "is_stdlib": true, "is_function_level": false, "scope": "module"}
{"id": "80ca6e7043804d2b20182213543c3a97aa9614e4", "type": "Import", "name": "datetime", "module": "datetime", "full_name": "datetime.datetime", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 38, "is_stdlib": true, "is_function_level": false, "scope": "module"}
{"id": "5adfe728377fbe1873662205a2b81d206348c270", "type": "Class", "name": "FinancialReportAgent", "lineno": 40, "end_lineno": 139, "docstring": null, "parsed_docstring": {}, "snippet": "class FinancialReportAgent:\n    def __init__(self, config_path: str, groq_api_key: str):\n        self.db_manager = DatabaseManager(config_path)\n        self.client = Groq(api_key=groq_api_key)\n        \n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)\n    \n    def get_kpi_status(self, kpi_name: str, value: float) -> str:\n        kpi_config = self.config['kpis'][kpi_name]\n...", "full_source_code": "class FinancialReportAgent:\n    def __init__(self, config_path: str, groq_api_key: str):\n        self.db_manager = DatabaseManager(config_path)\n        self.client = Groq(api_key=groq_api_key)\n        \n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)\n    \n    def get_kpi_status(self, kpi_name: str, value: float) -> str:\n        kpi_config = self.config['kpis'][kpi_name]\n        target = kpi_config['target']\n        warning = kpi_config['threshold_warning']\n        critical = kpi_config['threshold_critical']\n        \n        if kpi_name in ['on_time_delivery']:  # Higher is better\n            if value >= target:\n                return \"GOOD\"\n            elif value >= warning:\n                return \"WARNING\"\n            else:\n                return \"CRITICAL\"\n        else:  # Lower is better\n            if value <= target:\n                return \"GOOD\"\n            elif value <= warning:\n                return \"WARNING\"\n            else:\n                return \"CRITICAL\"\n    \n    def generate_report(self) -> str:\n        kpis = self.db_manager.calculate_kpis()\n        \n        # Prepare KPI summary\n        kpi_summary = []\n        for kpi_name, value in kpis.items():\n            status = self.get_kpi_status(kpi_name, value)\n            target = self.config['kpis'][kpi_name]['target']\n            description = self.config['kpis'][kpi_name]['description']\n            \n            kpi_summary.append({\n                'name': kpi_name,\n                'value': round(value, 1),\n                'target': target,\n                'status': status,\n                'description': description\n            })\n        \n        # Create prompt for LLM\n        prompt = f\"\"\"\n        You are a financial analyst AI. Generate a comprehensive financial report based on the following Purchase Order KPIs:\n\n        KPI Performance:\n        {chr(10).join([f\"- {kpi['description']}: {kpi['value']} (Target: {kpi['target']}) - Status: {kpi['status']}\" for kpi in kpi_summary])}\n\n        Please provide:\n        1. Executive Summary\n        2. KPI Analysis with insights (use numbered lists, NOT tables)\n        3. Risk Assessment\n        4. Recommendations for improvement\n\n        Format the report professionally with clear sections and actionable insights. Do NOT use markdown tables or pipe symbols.\n        \"\"\"\n        \n        response = self.client.chat.completions.create(\n            messages=[{\"role\": \"user\", \"content\": prompt}],\n            model=\"openai/gpt-oss-20b\",\n            temperature=0.3\n        )\n        \n        return response.choices[0].message.content\n    \n    def generate_pdf_report(self) -> tuple:\n        \"\"\"Generate both text and PDF reports\"\"\"\n        kpis = self.db_manager.calculate_kpis()\n        \n        # Prepare KPI summary\n        kpi_summary = []\n        for kpi_name, value in kpis.items():\n            status = self.get_kpi_status(kpi_name, value)\n            target = self.config['kpis'][kpi_name]['target']\n            description = self.config['kpis'][kpi_name]['description']\n            \n            kpi_summary.append({\n                'name': kpi_name,\n                'value': round(value, 1),\n                'target': target,\n                'status': status,\n                'description': description\n            })\n        \n        # Generate AI report\n        ai_report = self.generate_report()\n        \n        # Generate PDF\n        pdf_generator = PDFReportGenerator()\n        timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n        pdf_filename = f\"{timestamp}_PO_Report.pdf\"\n        pdf_generator.generate_pdf_report(kpi_summary, ai_report, pdf_filename)\n        \n        return ai_report, pdf_filename", "bases": [], "decorators": [], "num_methods": 4, "num_class_vars": 0, "is_private": false, "is_abstract": false, "embedding_semantics": "Class: FinancialReportAgent | Code:\nclass FinancialReportAgent:\n    def __init__(self, config_path: str, groq_api_key: str):\n        self.db_manager = DatabaseManager(config_path)\n        self.client = Groq(api_key=groq_api_key)\n        \n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)\n    \n    def get_kpi_status(self, kpi_name: str, value: float) -> str:\n        kpi_config = self.config['kpis'][kpi_name]\n..."}
{"id": "1b2002abce7a429b3da2d6ab089b3cf90e6f9a95", "type": "Method", "name": "__init__", "qualified_name": "FinancialReportAgent.__init__", "is_async": false, "is_method": true, "is_static": false, "is_class_method": false, "is_property": false, "is_private": false, "is_magic": true, "decorators": [], "decorator_details": [], "parameters": [{"name": "self", "type": null, "kind": "positional", "default": null, "position": 0}, {"name": "config_path", "type": "str", "kind": "positional", "default": null, "position": 1}, {"name": "groq_api_key", "type": "str", "kind": "positional", "default": null, "position": 2}], "return_type": null, "lineno": 41, "end_lineno": 46, "docstring": null, "parsed_docstring": {}, "snippet": "    def __init__(self, config_path: str, groq_api_key: str):\n        self.db_manager = DatabaseManager(config_path)\n        self.client = Groq(api_key=groq_api_key)\n        \n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)", "full_source_code": "def __init__(self, config_path: str, groq_api_key: str):\n        self.db_manager = DatabaseManager(config_path)\n        self.client = Groq(api_key=groq_api_key)\n        \n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)", "metrics": {"lines_of_code": 6, "complexity": 2, "num_parameters": 3, "num_returns": 0, "num_branches": 0, "num_loops": 0, "has_docstring": false, "num_decorators": 0, "max_nesting_depth": 1}, "embedding_semantics": "Method: __init__ | Args: (self, config_path, groq_api_key) | Code:\n    def __init__(self, config_path: str, groq_api_key: str):\n        self.db_manager = DatabaseManager(config_path)\n        self.client = Groq(api_key=groq_api_key)\n        \n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)"}
{"id": "934c023f368d485319574f1daf45139681a8dcca", "type": "Parameter", "name": "self", "param_type": null, "kind": "positional", "default": null, "position": 0}
{"id": "6b2d6fd1deb1cb4808c97d9eb9d2529bf3ca42cf", "type": "Parameter", "name": "config_path", "param_type": "str", "kind": "positional", "default": null, "position": 1}
{"id": "37af157b89ed8b2642a6b7182c7d9c0fcbeb7364", "type": "Parameter", "name": "groq_api_key", "param_type": "str", "kind": "positional", "default": null, "position": 2}
{"id": "26cc23d6ad3914e26e3f03e92c295c7495e6db78", "type": "Method", "name": "get_kpi_status", "qualified_name": "FinancialReportAgent.get_kpi_status", "is_async": false, "is_method": true, "is_static": false, "is_class_method": false, "is_property": false, "is_private": false, "is_magic": false, "decorators": [], "decorator_details": [], "parameters": [{"name": "self", "type": null, "kind": "positional", "default": null, "position": 0}, {"name": "kpi_name", "type": "str", "kind": "positional", "default": null, "position": 1}, {"name": "value", "type": "float", "kind": "positional", "default": null, "position": 2}], "return_type": "str", "lineno": 48, "end_lineno": 67, "docstring": null, "parsed_docstring": {}, "snippet": "    def get_kpi_status(self, kpi_name: str, value: float) -> str:\n        kpi_config = self.config['kpis'][kpi_name]\n        target = kpi_config['target']\n        warning = kpi_config['threshold_warning']\n        critical = kpi_config['threshold_critical']\n        \n        if kpi_name in ['on_time_delivery']:  # Higher is better\n            if value >= target:\n                return \"GOOD\"\n            elif value >= warning:\n...", "full_source_code": "def get_kpi_status(self, kpi_name: str, value: float) -> str:\n        kpi_config = self.config['kpis'][kpi_name]\n        target = kpi_config['target']\n        warning = kpi_config['threshold_warning']\n        critical = kpi_config['threshold_critical']\n        \n        if kpi_name in ['on_time_delivery']:  # Higher is better\n            if value >= target:\n                return \"GOOD\"\n            elif value >= warning:\n                return \"WARNING\"\n            else:\n                return \"CRITICAL\"\n        else:  # Lower is better\n            if value <= target:\n                return \"GOOD\"\n            elif value <= warning:\n                return \"WARNING\"\n            else:\n                return \"CRITICAL\"", "metrics": {"lines_of_code": 20, "complexity": 6, "num_parameters": 3, "num_returns": 6, "num_branches": 5, "num_loops": 0, "has_docstring": false, "num_decorators": 0, "max_nesting_depth": 3}, "embedding_semantics": "Method: get_kpi_status | Args: (self, kpi_name, value) | Returns: str | Code:\n    def get_kpi_status(self, kpi_name: str, value: float) -> str:\n        kpi_config = self.config['kpis'][kpi_name]\n        target = kpi_config['target']\n        warning = kpi_config['threshold_warning']\n        critical = kpi_config['threshold_critical']\n        \n        if kpi_name in ['on_time_delivery']:  # Higher is better\n            if value >= target:\n                return \"GOOD\"\n            elif value >= warning:\n..."}
{"id": "736e2fb1768b5b970d7a6f6cf11d1b1b62c8be93", "type": "Parameter", "name": "self", "param_type": null, "kind": "positional", "default": null, "position": 0}
{"id": "56399a2802ccec723547c201d3fb43b7826667c9", "type": "Parameter", "name": "kpi_name", "param_type": "str", "kind": "positional", "default": null, "position": 1}
{"id": "0957bd7db97c68a45a6f0666e62a97e0a324797d", "type": "Parameter", "name": "value", "param_type": "float", "kind": "positional", "default": null, "position": 2}
{"id": "b11a3feb8f62ab684a1fc87ddbd212b554f2283e", "type": "Variable", "name": "kpi_config", "value": "self.config['kpis'][kpi_name]", "value_type": "complex", "lineno": 49, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "8dfb516c9bfcf0c77b40c05bcd5be617e5abc58a", "type": "Variable", "name": "target", "value": "kpi_config['target']", "value_type": "complex", "lineno": 50, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "76331e0808a0d447a511c3b010d1a42e9d970343", "type": "Variable", "name": "warning", "value": "kpi_config['threshold_warning']", "value_type": "complex", "lineno": 51, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "73db9fd1a047fa15c5fc42611ddcbcb9f62f2d84", "type": "Variable", "name": "critical", "value": "kpi_config['threshold_critical']", "value_type": "complex", "lineno": 52, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "ec99bf9e8b36046c26ba96b9cf29ccca145b1cfd", "type": "Method", "name": "generate_report", "qualified_name": "FinancialReportAgent.generate_report", "is_async": false, "is_method": true, "is_static": false, "is_class_method": false, "is_property": false, "is_private": false, "is_magic": false, "decorators": [], "decorator_details": [], "parameters": [{"name": "self", "type": null, "kind": "positional", "default": null, "position": 0}], "return_type": "str", "lineno": 69, "end_lineno": 109, "docstring": null, "parsed_docstring": {}, "snippet": "    def generate_report(self) -> str:\n        kpis = self.db_manager.calculate_kpis()\n        \n        # Prepare KPI summary\n        kpi_summary = []\n        for kpi_name, value in kpis.items():\n            status = self.get_kpi_status(kpi_name, value)\n            target = self.config['kpis'][kpi_name]['target']\n            description = self.config['kpis'][kpi_name]['description']\n            \n...", "full_source_code": "def generate_report(self) -> str:\n        kpis = self.db_manager.calculate_kpis()\n        \n        # Prepare KPI summary\n        kpi_summary = []\n        for kpi_name, value in kpis.items():\n            status = self.get_kpi_status(kpi_name, value)\n            target = self.config['kpis'][kpi_name]['target']\n            description = self.config['kpis'][kpi_name]['description']\n            \n            kpi_summary.append({\n                'name': kpi_name,\n                'value': round(value, 1),\n                'target': target,\n                'status': status,\n                'description': description\n            })\n        \n        # Create prompt for LLM\n        prompt = f\"\"\"\n        You are a financial analyst AI. Generate a comprehensive financial report based on the following Purchase Order KPIs:\n\n        KPI Performance:\n        {chr(10).join([f\"- {kpi['description']}: {kpi['value']} (Target: {kpi['target']}) - Status: {kpi['status']}\" for kpi in kpi_summary])}\n\n        Please provide:\n        1. Executive Summary\n        2. KPI Analysis with insights (use numbered lists, NOT tables)\n        3. Risk Assessment\n        4. Recommendations for improvement\n\n        Format the report professionally with clear sections and actionable insights. Do NOT use markdown tables or pipe symbols.\n        \"\"\"\n        \n        response = self.client.chat.completions.create(\n            messages=[{\"role\": \"user\", \"content\": prompt}],\n            model=\"openai/gpt-oss-20b\",\n            temperature=0.3\n        )\n        \n        return response.choices[0].message.content", "metrics": {"lines_of_code": 41, "complexity": 2, "num_parameters": 1, "num_returns": 1, "num_branches": 0, "num_loops": 1, "has_docstring": false, "num_decorators": 0, "max_nesting_depth": 1}, "embedding_semantics": "Method: generate_report | Args: (self) | Returns: str | Code:\n    def generate_report(self) -> str:\n        kpis = self.db_manager.calculate_kpis()\n        \n        # Prepare KPI summary\n        kpi_summary = []\n        for kpi_name, value in kpis.items():\n            status = self.get_kpi_status(kpi_name, value)\n            target = self.config['kpis'][kpi_name]['target']\n            description = self.config['kpis'][kpi_name]['description']\n            \n..."}
{"id": "8d1e118f8755dc80345f36cd0fd7f93d88fa3fe7", "type": "Parameter", "name": "self", "param_type": null, "kind": "positional", "default": null, "position": 0}
{"id": "fe894a3a0ff30ac26549b20928b11c25f8ace7b9", "type": "Variable", "name": "kpis", "value": "self.db_manager.calculate_kpis()", "value_type": "complex", "lineno": 70, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "c203b29ea21ca36dc509c5415b35b47703c82bd9", "type": "Variable", "name": "kpi_summary", "value": "[]", "value_type": "complex", "lineno": 73, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "2c0808cd7bbad382249e124af3edcfa54406bd46", "type": "Variable", "name": "status", "value": "self.get_kpi_status(kpi_name, value)", "value_type": "complex", "lineno": 75, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "27491af97566dd1c44187ab6c484aac43aefc977", "type": "Variable", "name": "target", "value": "self.config['kpis'][kpi_name]['target']", "value_type": "complex", "lineno": 76, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "1e6ea4673a458220817ec53a089b475bde43dbab", "type": "Variable", "name": "description", "value": "self.config['kpis'][kpi_name]['description']", "value_type": "complex", "lineno": 77, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "99c8ce5d728a935daab8c9efa074a355554f277a", "type": "Variable", "name": "prompt", "value": "f\"\"\"\\n        You are a financial analyst AI. Generate a comprehensive financial report based on the following Purchase Order KPIs:\\n\\n        KPI Performance:\\n        {chr(10).join([f\"- {kpi['descri", "value_type": "complex", "lineno": 88, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "707ea9381790eec1aae9302a1d311c6d0aedcade", "type": "Variable", "name": "response", "value": "self.client.chat.completions.create(messages=[{'role': 'user', 'content': prompt}], model='openai/gpt-oss-20b', temperature=0.3)", "value_type": "complex", "lineno": 103, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "5f08c3594f10780a76292d71e8df8351dfc9c4d6", "type": "Method", "name": "generate_pdf_report", "qualified_name": "FinancialReportAgent.generate_pdf_report", "is_async": false, "is_method": true, "is_static": false, "is_class_method": false, "is_property": false, "is_private": false, "is_magic": false, "decorators": [], "decorator_details": [], "parameters": [{"name": "self", "type": null, "kind": "positional", "default": null, "position": 0}], "return_type": "tuple", "lineno": 111, "end_lineno": 139, "docstring": "Generate both text and PDF reports", "parsed_docstring": {"summary": "Generate both text and PDF reports", "description": "", "parameters": [], "returns": null, "raises": [], "examples": [], "notes": [], "attributes": [], "style": "unknown"}, "snippet": "    def generate_pdf_report(self) -> tuple:\n        \"\"\"Generate both text and PDF reports\"\"\"\n        kpis = self.db_manager.calculate_kpis()\n        \n        # Prepare KPI summary\n        kpi_summary = []\n        for kpi_name, value in kpis.items():\n            status = self.get_kpi_status(kpi_name, value)\n            target = self.config['kpis'][kpi_name]['target']\n            description = self.config['kpis'][kpi_name]['description']\n...", "full_source_code": "def generate_pdf_report(self) -> tuple:\n        \"\"\"Generate both text and PDF reports\"\"\"\n        kpis = self.db_manager.calculate_kpis()\n        \n        # Prepare KPI summary\n        kpi_summary = []\n        for kpi_name, value in kpis.items():\n            status = self.get_kpi_status(kpi_name, value)\n            target = self.config['kpis'][kpi_name]['target']\n            description = self.config['kpis'][kpi_name]['description']\n            \n            kpi_summary.append({\n                'name': kpi_name,\n                'value': round(value, 1),\n                'target': target,\n                'status': status,\n                'description': description\n            })\n        \n        # Generate AI report\n        ai_report = self.generate_report()\n        \n        # Generate PDF\n        pdf_generator = PDFReportGenerator()\n        timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n        pdf_filename = f\"{timestamp}_PO_Report.pdf\"\n        pdf_generator.generate_pdf_report(kpi_summary, ai_report, pdf_filename)\n        \n        return ai_report, pdf_filename", "metrics": {"lines_of_code": 29, "complexity": 2, "num_parameters": 1, "num_returns": 1, "num_branches": 0, "num_loops": 1, "has_docstring": true, "num_decorators": 0, "max_nesting_depth": 1}, "embedding_semantics": "Method: generate_pdf_report | Args: (self) | Returns: tuple | Documentation:\nGenerate both text and PDF reports"}
{"id": "e9df7be79f424cf7569888958ec7af1bfc6c9bb9", "type": "Parameter", "name": "self", "param_type": null, "kind": "positional", "default": null, "position": 0}
{"id": "35f3d956379de6f597a82b1e582bebfd6c6bffa7", "type": "Variable", "name": "kpis", "value": "self.db_manager.calculate_kpis()", "value_type": "complex", "lineno": 113, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "377bb4b7e05f22a56885e4f5f91e2037544fd7c6", "type": "Variable", "name": "kpi_summary", "value": "[]", "value_type": "complex", "lineno": 116, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "6daa792acf491cac64bc205f6369d6fae4c6ee9b", "type": "Variable", "name": "status", "value": "self.get_kpi_status(kpi_name, value)", "value_type": "complex", "lineno": 118, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "ba990cd0f8b732e0cd02f00166ef163af8d254d9", "type": "Variable", "name": "target", "value": "self.config['kpis'][kpi_name]['target']", "value_type": "complex", "lineno": 119, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "35a45478365dcf5fbd6f7031b01544625ba72090", "type": "Variable", "name": "description", "value": "self.config['kpis'][kpi_name]['description']", "value_type": "complex", "lineno": 120, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "8e8f4fa9f78b41f3ac169c8ff407548177c608f5", "type": "Variable", "name": "ai_report", "value": "self.generate_report()", "value_type": "complex", "lineno": 131, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "253c068afb9cc0f5f8b43be9a1eb27df3af09629", "type": "Variable", "name": "pdf_generator", "value": "PDFReportGenerator()", "value_type": "complex", "lineno": 134, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "47dc5b225985b73c34fea5b722ec83c6209838d8", "type": "Variable", "name": "timestamp", "value": "datetime.now().strftime('%Y%m%d_%H%M%S')", "value_type": "complex", "lineno": 135, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "5053491dcfe115bec98e9b5c77b69937323788d1", "type": "Variable", "name": "pdf_filename", "value": "f'{timestamp}_PO_Report.pdf'", "value_type": "complex", "lineno": 136, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "7c1cc51a51a24a3b177018496fce8c38b98b2d50", "type": "File", "name": "database_manager.py", "path": "/home/sahil/Workspace/Source Wall/Simple_Financial_Agent/database_manager.py", "relpath": "database_manager.py", "module": "database_manager", "extension": ".py", "sha1": "832023b3800f5f1c6c00f5204a29d1d2e5124bcd", "lines_of_code": 83, "source_code": "'''\nDatabase Manager for KPI Extraction\n-----------------------------------\n\nThis module defines the `DatabaseManager` class, responsible for connecting to a \nSQLite-based procurement database and computing key performance indicators (KPIs) \nused in financial and operational reporting.\n\nCore Responsibilities:\n- Establishes a connection to the configured SQLite database\n- Executes parameterized SQL queries from a YAML configuration file\n- Calculates essential procurement KPIs, including:\n    - Purchase Order (PO) Cycle Time\n    - On-time Delivery Rate\n    - Emergency Order Rate\n    - PO Amendment Rate\n    - Supplier Defect Rate\n- Returns KPI results as a dictionary for downstream AI or report generation processes\n\nStructure:\n- `execute_query(query)`: Executes a SQL query and returns a pandas DataFrame\n- `calculate_kpis()`: Runs pre-defined KPI queries and computes summary metrics\n\nUsage:\n1. Provide a YAML configuration file containing database path and SQL queries.\n2. Instantiate the class and call `calculate_kpis()` to retrieve KPI values.\n\nExample:\n    db_manager = DatabaseManager(\"config.yaml\")\n    kpis = db_manager.calculate_kpis()\n    print(kpis)\n'''\n\nimport os\nimport sqlite3\nimport pandas as pd\nimport yaml\nfrom typing import Dict, Any\n\nclass DatabaseManager:\n    def __init__(self, config_path: str):\n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)\n        # Use the database from the parent directory if it exists, otherwise current directory\n        db_name = self.config['database']['path']\n        if os.path.exists(f'../{db_name}'):\n            self.db_path = f'../{db_name}'\n        else:\n            self.db_path = db_name\n    \n    def execute_query(self, query: str) -> pd.DataFrame:\n        with sqlite3.connect(self.db_path) as conn:\n            return pd.read_sql_query(query, conn)\n    \n    def calculate_kpis(self) -> Dict[str, Any]:\n        kpis = {}\n        \n        # PO Cycle Time\n        cycle_query = self.config['queries']['kpi_cycle_time']\n        cycle_data = self.execute_query(cycle_query)\n        kpis['po_cycle_time'] = cycle_data['cycle_days'].mean()\n        \n        # On-time Delivery\n        delivery_query = self.config['queries']['kpi_delivery_performance']\n        delivery_data = self.execute_query(delivery_query)\n        kpis['on_time_delivery'] = (delivery_data['on_time'].sum() / len(delivery_data)) * 100\n        \n        # Emergency Orders\n        emergency_query = self.config['queries']['kpi_emergency_orders']\n        emergency_data = self.execute_query(emergency_query)\n        kpis['emergency_order_rate'] = (emergency_data.iloc[0]['emergency_orders'] / emergency_data.iloc[0]['total_orders']) * 100\n        \n        # Amendments\n        amendment_query = self.config['queries']['kpi_amendments']\n        amendment_data = self.execute_query(amendment_query)\n        kpis['po_amendment_rate'] = (amendment_data.iloc[0]['amended_orders'] / amendment_data.iloc[0]['total_orders']) * 100\n        \n        # Defects\n        defect_query = self.config['queries']['kpi_defects']\n        defect_data = self.execute_query(defect_query)\n        kpis['supplier_defect_rate'] = (defect_data.iloc[0]['defective_items'] / defect_data.iloc[0]['total_items']) * 100\n        \n        return kpis", "size_bytes": 3286, "language": "python", "encoding": "utf-8", "embedding_semantics": "File: database_manager.py | Module: database_manager | Documentation:\nDatabase Manager for KPI Extraction\n-----------------------------------\n\nThis module defines the `DatabaseManager` class, responsible for connecting to a \nSQLite-based procurement database and computing key performance indicators (KPIs) \nused in financial and operational reporting.\n\nCore Responsibilities:\n- Establishes a connection to the configured SQLite database\n- Executes parameterized SQL queries from a YAML configuration file\n- Calculates essential procurement KPIs, including:\n    - Purchase Order (PO) Cycle Time\n    - On-time Delivery Rate\n    - Emergency Order Rate\n    - PO Amendment Rate\n    - Supplier Defect Rate\n- Returns KPI results as a dictionary for downstream AI or report generation processes\n\nStructure:\n- `execute_query(query)`: Executes a SQL query and returns a pandas DataFrame\n- `calculate_kpis()`: Runs pre-defined KPI queries and computes summary metrics\n\nUsage:\n1. Provide a YAML configuration file containing database path and SQL queries.\n2. Instantiate the class and call `calculate_kpis()` to retrieve KPI values.\n\nExample:\n    db_manager = DatabaseManager(\"config.yaml\")\n    kpis = db_manager.calculate_kpis()\n    print(kpis)"}
{"id": "74de9d0d6efc640bce6794cc94c52a2c579b2dfe", "type": "Import", "name": "os", "alias": null, "import_type": "direct", "lineno": 34, "is_stdlib": true, "is_relative": false, "level": 0, "is_function_level": false, "scope": "module"}
{"id": "98a607640a090894fec327ccc41f3cc69a46f41c", "type": "Import", "name": "sqlite3", "alias": null, "import_type": "direct", "lineno": 35, "is_stdlib": false, "is_relative": false, "level": 0, "is_function_level": false, "scope": "module"}
{"id": "bcee4e9027cbc7335398e9ef073f192ee12e5d77", "type": "Import", "name": "pandas", "alias": "pd", "import_type": "direct", "lineno": 36, "is_stdlib": false, "is_relative": false, "level": 0, "is_function_level": false, "scope": "module"}
{"id": "7e0d507e4e49cd6aa76bbd2a54dd5b9de3ec93de", "type": "Import", "name": "yaml", "alias": null, "import_type": "direct", "lineno": 37, "is_stdlib": false, "is_relative": false, "level": 0, "is_function_level": false, "scope": "module"}
{"id": "49c4177121a4351aa5986b350ee9361b32d4e583", "type": "Import", "name": "Dict", "module": "typing", "full_name": "typing.Dict", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 38, "is_stdlib": true, "is_function_level": false, "scope": "module"}
{"id": "ebdfaf6f46411a868f8d74baa6dec57b74564aa8", "type": "Import", "name": "Any", "module": "typing", "full_name": "typing.Any", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 38, "is_stdlib": true, "is_function_level": false, "scope": "module"}
{"id": "7b6313c6f7668a7b496ff748c74657c0247bf3eb", "type": "Class", "name": "DatabaseManager", "lineno": 40, "end_lineno": 83, "docstring": null, "parsed_docstring": {}, "snippet": "class DatabaseManager:\n    def __init__(self, config_path: str):\n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)\n        # Use the database from the parent directory if it exists, otherwise current directory\n        db_name = self.config['database']['path']\n        if os.path.exists(f'../{db_name}'):\n            self.db_path = f'../{db_name}'\n        else:\n            self.db_path = db_name\n...", "full_source_code": "class DatabaseManager:\n    def __init__(self, config_path: str):\n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)\n        # Use the database from the parent directory if it exists, otherwise current directory\n        db_name = self.config['database']['path']\n        if os.path.exists(f'../{db_name}'):\n            self.db_path = f'../{db_name}'\n        else:\n            self.db_path = db_name\n    \n    def execute_query(self, query: str) -> pd.DataFrame:\n        with sqlite3.connect(self.db_path) as conn:\n            return pd.read_sql_query(query, conn)\n    \n    def calculate_kpis(self) -> Dict[str, Any]:\n        kpis = {}\n        \n        # PO Cycle Time\n        cycle_query = self.config['queries']['kpi_cycle_time']\n        cycle_data = self.execute_query(cycle_query)\n        kpis['po_cycle_time'] = cycle_data['cycle_days'].mean()\n        \n        # On-time Delivery\n        delivery_query = self.config['queries']['kpi_delivery_performance']\n        delivery_data = self.execute_query(delivery_query)\n        kpis['on_time_delivery'] = (delivery_data['on_time'].sum() / len(delivery_data)) * 100\n        \n        # Emergency Orders\n        emergency_query = self.config['queries']['kpi_emergency_orders']\n        emergency_data = self.execute_query(emergency_query)\n        kpis['emergency_order_rate'] = (emergency_data.iloc[0]['emergency_orders'] / emergency_data.iloc[0]['total_orders']) * 100\n        \n        # Amendments\n        amendment_query = self.config['queries']['kpi_amendments']\n        amendment_data = self.execute_query(amendment_query)\n        kpis['po_amendment_rate'] = (amendment_data.iloc[0]['amended_orders'] / amendment_data.iloc[0]['total_orders']) * 100\n        \n        # Defects\n        defect_query = self.config['queries']['kpi_defects']\n        defect_data = self.execute_query(defect_query)\n        kpis['supplier_defect_rate'] = (defect_data.iloc[0]['defective_items'] / defect_data.iloc[0]['total_items']) * 100\n        \n        return kpis", "bases": [], "decorators": [], "num_methods": 3, "num_class_vars": 0, "is_private": false, "is_abstract": false, "embedding_semantics": "Class: DatabaseManager | Code:\nclass DatabaseManager:\n    def __init__(self, config_path: str):\n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)\n        # Use the database from the parent directory if it exists, otherwise current directory\n        db_name = self.config['database']['path']\n        if os.path.exists(f'../{db_name}'):\n            self.db_path = f'../{db_name}'\n        else:\n            self.db_path = db_name\n..."}
{"id": "85bc73b432c5ff2a8ede43b84cdc68dd8ad0239e", "type": "Method", "name": "__init__", "qualified_name": "DatabaseManager.__init__", "is_async": false, "is_method": true, "is_static": false, "is_class_method": false, "is_property": false, "is_private": false, "is_magic": true, "decorators": [], "decorator_details": [], "parameters": [{"name": "self", "type": null, "kind": "positional", "default": null, "position": 0}, {"name": "config_path", "type": "str", "kind": "positional", "default": null, "position": 1}], "return_type": null, "lineno": 41, "end_lineno": 49, "docstring": null, "parsed_docstring": {}, "snippet": "    def __init__(self, config_path: str):\n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)\n        # Use the database from the parent directory if it exists, otherwise current directory\n        db_name = self.config['database']['path']\n        if os.path.exists(f'../{db_name}'):\n            self.db_path = f'../{db_name}'\n        else:\n            self.db_path = db_name", "full_source_code": "def __init__(self, config_path: str):\n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)\n        # Use the database from the parent directory if it exists, otherwise current directory\n        db_name = self.config['database']['path']\n        if os.path.exists(f'../{db_name}'):\n            self.db_path = f'../{db_name}'\n        else:\n            self.db_path = db_name", "metrics": {"lines_of_code": 9, "complexity": 3, "num_parameters": 2, "num_returns": 0, "num_branches": 1, "num_loops": 0, "has_docstring": false, "num_decorators": 0, "max_nesting_depth": 1}, "embedding_semantics": "Method: __init__ | Args: (self, config_path) | Code:\n    def __init__(self, config_path: str):\n        with open(config_path, 'r') as f:\n            self.config = yaml.safe_load(f)\n        # Use the database from the parent directory if it exists, otherwise current directory\n        db_name = self.config['database']['path']\n        if os.path.exists(f'../{db_name}'):\n            self.db_path = f'../{db_name}'\n        else:\n            self.db_path = db_name"}
{"id": "471dcb83f32a559b65dcb7b983eaa242307529ba", "type": "Parameter", "name": "self", "param_type": null, "kind": "positional", "default": null, "position": 0}
{"id": "5a4a1c2e66e80f7ed780681cb82b299d72ec727b", "type": "Parameter", "name": "config_path", "param_type": "str", "kind": "positional", "default": null, "position": 1}
{"id": "f7473cea7a62e9a960c876a022eedce955a4ffd0", "type": "Variable", "name": "db_name", "value": "self.config['database']['path']", "value_type": "complex", "lineno": 45, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "a12c6e5d8fa480810eebf73f0344653055469429", "type": "Method", "name": "execute_query", "qualified_name": "DatabaseManager.execute_query", "is_async": false, "is_method": true, "is_static": false, "is_class_method": false, "is_property": false, "is_private": false, "is_magic": false, "decorators": [], "decorator_details": [], "parameters": [{"name": "self", "type": null, "kind": "positional", "default": null, "position": 0}, {"name": "query", "type": "str", "kind": "positional", "default": null, "position": 1}], "return_type": "pd.DataFrame", "lineno": 51, "end_lineno": 53, "docstring": null, "parsed_docstring": {}, "snippet": "    def execute_query(self, query: str) -> pd.DataFrame:\n        with sqlite3.connect(self.db_path) as conn:\n            return pd.read_sql_query(query, conn)", "full_source_code": "def execute_query(self, query: str) -> pd.DataFrame:\n        with sqlite3.connect(self.db_path) as conn:\n            return pd.read_sql_query(query, conn)", "metrics": {"lines_of_code": 3, "complexity": 2, "num_parameters": 2, "num_returns": 1, "num_branches": 0, "num_loops": 0, "has_docstring": false, "num_decorators": 0, "max_nesting_depth": 1}, "embedding_semantics": "Method: execute_query | Args: (self, query) | Returns: pd.DataFrame | Code:\n    def execute_query(self, query: str) -> pd.DataFrame:\n        with sqlite3.connect(self.db_path) as conn:\n            return pd.read_sql_query(query, conn)"}
{"id": "4d516118c7ef95f1b6d5b82e5bef1a001022ec37", "type": "Parameter", "name": "self", "param_type": null, "kind": "positional", "default": null, "position": 0}
{"id": "5dabb81b26ae10ca18cf94cc6d45553d1b3c2957", "type": "Parameter", "name": "query", "param_type": "str", "kind": "positional", "default": null, "position": 1}
{"id": "e0b83569c9ccf161ab6620ffe609ea0dfe234f05", "type": "Method", "name": "calculate_kpis", "qualified_name": "DatabaseManager.calculate_kpis", "is_async": false, "is_method": true, "is_static": false, "is_class_method": false, "is_property": false, "is_private": false, "is_magic": false, "decorators": [], "decorator_details": [], "parameters": [{"name": "self", "type": null, "kind": "positional", "default": null, "position": 0}], "return_type": "Dict[str, Any]", "lineno": 55, "end_lineno": 83, "docstring": null, "parsed_docstring": {}, "snippet": "    def calculate_kpis(self) -> Dict[str, Any]:\n        kpis = {}\n        \n        # PO Cycle Time\n        cycle_query = self.config['queries']['kpi_cycle_time']\n        cycle_data = self.execute_query(cycle_query)\n        kpis['po_cycle_time'] = cycle_data['cycle_days'].mean()\n        \n        # On-time Delivery\n        delivery_query = self.config['queries']['kpi_delivery_performance']\n...", "full_source_code": "def calculate_kpis(self) -> Dict[str, Any]:\n        kpis = {}\n        \n        # PO Cycle Time\n        cycle_query = self.config['queries']['kpi_cycle_time']\n        cycle_data = self.execute_query(cycle_query)\n        kpis['po_cycle_time'] = cycle_data['cycle_days'].mean()\n        \n        # On-time Delivery\n        delivery_query = self.config['queries']['kpi_delivery_performance']\n        delivery_data = self.execute_query(delivery_query)\n        kpis['on_time_delivery'] = (delivery_data['on_time'].sum() / len(delivery_data)) * 100\n        \n        # Emergency Orders\n        emergency_query = self.config['queries']['kpi_emergency_orders']\n        emergency_data = self.execute_query(emergency_query)\n        kpis['emergency_order_rate'] = (emergency_data.iloc[0]['emergency_orders'] / emergency_data.iloc[0]['total_orders']) * 100\n        \n        # Amendments\n        amendment_query = self.config['queries']['kpi_amendments']\n        amendment_data = self.execute_query(amendment_query)\n        kpis['po_amendment_rate'] = (amendment_data.iloc[0]['amended_orders'] / amendment_data.iloc[0]['total_orders']) * 100\n        \n        # Defects\n        defect_query = self.config['queries']['kpi_defects']\n        defect_data = self.execute_query(defect_query)\n        kpis['supplier_defect_rate'] = (defect_data.iloc[0]['defective_items'] / defect_data.iloc[0]['total_items']) * 100\n        \n        return kpis", "metrics": {"lines_of_code": 29, "complexity": 1, "num_parameters": 1, "num_returns": 1, "num_branches": 0, "num_loops": 0, "has_docstring": false, "num_decorators": 0, "max_nesting_depth": 0}, "embedding_semantics": "Method: calculate_kpis | Args: (self) | Returns: Dict[str, Any] | Code:\n    def calculate_kpis(self) -> Dict[str, Any]:\n        kpis = {}\n        \n        # PO Cycle Time\n        cycle_query = self.config['queries']['kpi_cycle_time']\n        cycle_data = self.execute_query(cycle_query)\n        kpis['po_cycle_time'] = cycle_data['cycle_days'].mean()\n        \n        # On-time Delivery\n        delivery_query = self.config['queries']['kpi_delivery_performance']\n..."}
{"id": "8a225286087f4a12518b2dff269bd1cfb31e6fae", "type": "Parameter", "name": "self", "param_type": null, "kind": "positional", "default": null, "position": 0}
{"id": "441ce9b098bac5475f02fc64b412d887eb9f2f28", "type": "Variable", "name": "kpis", "value": "{}", "value_type": "complex", "lineno": 56, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "63fd463e82fd525b1fc92262507c6819690574f2", "type": "Variable", "name": "cycle_query", "value": "self.config['queries']['kpi_cycle_time']", "value_type": "complex", "lineno": 59, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "1876236b0e366a4b37b883d24ede9b79540cf47c", "type": "Variable", "name": "cycle_data", "value": "self.execute_query(cycle_query)", "value_type": "complex", "lineno": 60, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "497a63bf2c0b387d1c5e4ef9f188f99b85998a0b", "type": "Variable", "name": "delivery_query", "value": "self.config['queries']['kpi_delivery_performance']", "value_type": "complex", "lineno": 64, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "9606df9142e926c1a1857e3646f74fb55f77bb42", "type": "Variable", "name": "delivery_data", "value": "self.execute_query(delivery_query)", "value_type": "complex", "lineno": 65, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "db200d4c62a5d0f952144b9200fbe8b6b82c6c3c", "type": "Variable", "name": "emergency_query", "value": "self.config['queries']['kpi_emergency_orders']", "value_type": "complex", "lineno": 69, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "9d38bd8dcae0e53f475fdd30a848f74781713ff3", "type": "Variable", "name": "emergency_data", "value": "self.execute_query(emergency_query)", "value_type": "complex", "lineno": 70, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "78ee0c0a41aa331f5cfce19a0e21767e6199d531", "type": "Variable", "name": "amendment_query", "value": "self.config['queries']['kpi_amendments']", "value_type": "complex", "lineno": 74, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "0d43c1baae2d2c72e72e0373e5dc0ea52179d05d", "type": "Variable", "name": "amendment_data", "value": "self.execute_query(amendment_query)", "value_type": "complex", "lineno": 75, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "40525dfc3255970eaf64189a3a578b0b09007165", "type": "Variable", "name": "defect_query", "value": "self.config['queries']['kpi_defects']", "value_type": "complex", "lineno": 79, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "938676c7cc8d9435115a1c3e015dfec1ea53e47b", "type": "Variable", "name": "defect_data", "value": "self.execute_query(defect_query)", "value_type": "complex", "lineno": 80, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "3ff30231059ea07629543765f4e95835904d36f8", "type": "File", "name": "pdf_generator.py", "path": "/home/sahil/Workspace/Source Wall/Simple_Financial_Agent/pdf_generator.py", "relpath": "pdf_generator.py", "module": "pdf_generator", "extension": ".py", "sha1": "8414bd0e02f2196343199aaccfa16a3729047a67", "lines_of_code": 147, "source_code": "'''\nPDF Report Generator\n--------------------\n\nThis module defines the `PDFReportGenerator` class, responsible for creating\nprofessionally formatted PDF reports that summarize purchase order KPIs and\nAI-generated financial analysis.\n\nCore Responsibilities:\n- Build structured PDF reports using ReportLab\n- Display KPI metrics in color-coded summary tables (Good, Warning, Critical)\n- Format and include AI-generated analysis into readable, styled paragraphs\n- Automatically timestamp and name generated report files\n\nFeatures:\n- Custom title and section heading styles\n- Alternating table row colors for readability\n- Dynamic text color coding for KPI performance levels\n- Markdown and HTML cleanup for safe text rendering\n\nStructure:\n- `generate_pdf_report(kpi_data, ai_report, filename=None)`: \n    Creates a full PDF report with KPI summary and AI narrative.\n\nUsage:\n    pdf_generator = PDFReportGenerator()\n    pdf_path = pdf_generator.generate_pdf_report(kpi_data, ai_text)\n    print(f\"Report saved to: {pdf_path}\")\n'''\n\n\nfrom reportlab.lib.pagesizes import letter, A4\nfrom reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Table, TableStyle\nfrom reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle\nfrom reportlab.lib.units import inch\nfrom reportlab.lib import colors\nfrom datetime import datetime\nimport os\n\nclass PDFReportGenerator:\n    def __init__(self):\n        self.styles = getSampleStyleSheet()\n        self.title_style = ParagraphStyle(\n            'CustomTitle',\n            parent=self.styles['Heading1'],\n            fontSize=18,\n            spaceAfter=30,\n            alignment=1  # Center alignment\n        )\n        self.heading_style = ParagraphStyle(\n            'CustomHeading',\n            parent=self.styles['Heading2'],\n            fontSize=14,\n            spaceAfter=12,\n            textColor=colors.darkblue\n        )\n    \n    def generate_pdf_report(self, kpi_data, ai_report, filename=None):\n        if not filename:\n            timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n            filename = f\"{timestamp}_PO_Report.pdf\"\n        \n        doc = SimpleDocTemplate(filename, pagesize=A4)\n        story = []\n        \n        # Title\n        title = Paragraph(\"Purchase Order Performance Report\", self.title_style)\n        story.append(title)\n        story.append(Spacer(1, 20))\n        \n        # Report Date\n        date_text = f\"Report Generated: {datetime.now().strftime('%B %d, %Y at %I:%M %p')}\"\n        story.append(Paragraph(date_text, self.styles['Normal']))\n        story.append(Spacer(1, 20))\n        \n        # KPI Summary Table\n        story.append(Paragraph(\"Key Performance Indicators Summary\", self.heading_style))\n        \n        kpi_table_data = [['KPI Description', 'Current', 'Target', 'Status']]\n        for kpi in kpi_data:\n            kpi_table_data.append([\n                kpi['description'],\n                f\"{kpi['value']}\",\n                f\"{kpi['target']}\",\n                kpi['status']\n            ])\n        \n        kpi_table = Table(kpi_table_data, colWidths=[3.5*inch, 1*inch, 1*inch, 1*inch])\n        kpi_table.setStyle(TableStyle([\n            # Header styling\n            ('BACKGROUND', (0, 0), (-1, 0), colors.darkblue),\n            ('TEXTCOLOR', (0, 0), (-1, 0), colors.white),\n            ('ALIGN', (0, 0), (-1, -1), 'LEFT'),\n            ('ALIGN', (1, 0), (-1, -1), 'CENTER'),\n            ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),\n            ('FONTSIZE', (0, 0), (-1, 0), 11),\n            ('BOTTOMPADDING', (0, 0), (-1, 0), 12),\n            ('TOPPADDING', (0, 0), (-1, 0), 12),\n            \n            # Data rows styling\n            ('BACKGROUND', (0, 1), (-1, -1), colors.white),\n            ('FONTNAME', (0, 1), (-1, -1), 'Helvetica'),\n            ('FONTSIZE', (0, 1), (-1, -1), 10),\n            ('ROWBACKGROUNDS', (0, 1), (-1, -1), [colors.white, colors.lightgrey]),\n            \n            # Grid and padding\n            ('GRID', (0, 0), (-1, -1), 1, colors.black),\n            ('VALIGN', (0, 0), (-1, -1), 'MIDDLE'),\n            ('LEFTPADDING', (0, 0), (-1, -1), 8),\n            ('RIGHTPADDING', (0, 0), (-1, -1), 8),\n            ('TOPPADDING', (0, 1), (-1, -1), 8),\n            ('BOTTOMPADDING', (0, 1), (-1, -1), 8)\n        ]))\n        \n        # Add status-specific coloring\n        for i, kpi in enumerate(kpi_data, 1):\n            if kpi['status'] == 'GOOD':\n                kpi_table.setStyle(TableStyle([('TEXTCOLOR', (3, i), (3, i), colors.green)]))\n            elif kpi['status'] == 'CRITICAL':\n                kpi_table.setStyle(TableStyle([('TEXTCOLOR', (3, i), (3, i), colors.red)]))\n            else:  # WARNING\n                kpi_table.setStyle(TableStyle([('TEXTCOLOR', (3, i), (3, i), colors.orange)]))\n        \n        story.append(kpi_table)\n        story.append(Spacer(1, 30))\n        \n        # AI Analysis\n        story.append(Paragraph(\"AI-Generated Analysis\", self.heading_style))\n        \n        # Split AI report into paragraphs\n        ai_paragraphs = ai_report.split('\\n\\n')\n        for paragraph in ai_paragraphs:\n            if paragraph.strip():\n                # Handle markdown-style headers\n                if paragraph.startswith('**') and paragraph.endswith('**'):\n                    clean_text = paragraph.replace('**', '')\n                    story.append(Paragraph(clean_text, self.heading_style))\n                else:\n                    # Clean up markdown formatting - remove all markdown\n                    clean_text = paragraph.replace('**', '').replace('*', '')\n                    # Remove any HTML-like tags that might cause issues\n                    clean_text = clean_text.replace('<', '&lt;').replace('>', '&gt;')\n                    story.append(Paragraph(clean_text, self.styles['Normal']))\n                story.append(Spacer(1, 12))\n        \n        doc.build(story)\n        return filename", "size_bytes": 5875, "language": "python", "encoding": "utf-8", "embedding_semantics": "File: pdf_generator.py | Module: pdf_generator | Documentation:\nPDF Report Generator\n--------------------\n\nThis module defines the `PDFReportGenerator` class, responsible for creating\nprofessionally formatted PDF reports that summarize purchase order KPIs and\nAI-generated financial analysis.\n\nCore Responsibilities:\n- Build structured PDF reports using ReportLab\n- Display KPI metrics in color-coded summary tables (Good, Warning, Critical)\n- Format and include AI-generated analysis into readable, styled paragraphs\n- Automatically timestamp and name generated report files\n\nFeatures:\n- Custom title and section heading styles\n- Alternating table row colors for readability\n- Dynamic text color coding for KPI performance levels\n- Markdown and HTML cleanup for safe text rendering\n\nStructure:\n- `generate_pdf_report(kpi_data, ai_report, filename=None)`: \n    Creates a full PDF report with KPI summary and AI narrative.\n\nUsage:\n    pdf_generator = PDFReportGenerator()\n    pdf_path = pdf_generator.generate_pdf_report(kpi_data, ai_text)\n    print(f\"Report saved to: {pdf_path}\")"}
{"id": "1c00cae3f7ba59a8c1c648a8eb4d6611edf71f89", "type": "Import", "name": "letter", "module": "reportlab.lib.pagesizes", "full_name": "reportlab.lib.pagesizes.letter", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 32, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "f632ca12c62a8ceee10ef20af4d1f7b0cd102130", "type": "Import", "name": "A4", "module": "reportlab.lib.pagesizes", "full_name": "reportlab.lib.pagesizes.A4", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 32, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "31ebf476ac3efc12c7cabb60ecacc65d63b62b26", "type": "Import", "name": "SimpleDocTemplate", "module": "reportlab.platypus", "full_name": "reportlab.platypus.SimpleDocTemplate", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 33, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "7452a8c9dbfdb0df1733f6cb50fc43423ed40ad2", "type": "Import", "name": "Paragraph", "module": "reportlab.platypus", "full_name": "reportlab.platypus.Paragraph", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 33, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "4b6e9dbb45fdce1988951a4759f1871cf7996265", "type": "Import", "name": "Spacer", "module": "reportlab.platypus", "full_name": "reportlab.platypus.Spacer", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 33, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "8c24387070c31d3a5d165383ad7f68ba45d2c5e0", "type": "Import", "name": "Table", "module": "reportlab.platypus", "full_name": "reportlab.platypus.Table", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 33, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "b99abbc336caa07f7ae02a2fc610d8f7f0f7cbef", "type": "Import", "name": "TableStyle", "module": "reportlab.platypus", "full_name": "reportlab.platypus.TableStyle", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 33, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "051739bf5f94dcd147f9c8166b2b5b06a4e4d081", "type": "Import", "name": "getSampleStyleSheet", "module": "reportlab.lib.styles", "full_name": "reportlab.lib.styles.getSampleStyleSheet", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 34, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "0af54d6c499d61d5b4ca1c313ff2b060e56eefe8", "type": "Import", "name": "ParagraphStyle", "module": "reportlab.lib.styles", "full_name": "reportlab.lib.styles.ParagraphStyle", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 34, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "9a1ebdb0d50ce586c58f807d831f9ca646591d9f", "type": "Import", "name": "inch", "module": "reportlab.lib.units", "full_name": "reportlab.lib.units.inch", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 35, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "ad5ddd18dea1b3d2c6389f8e6dc1de7ba203a060", "type": "Import", "name": "colors", "module": "reportlab.lib", "full_name": "reportlab.lib.colors", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 36, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "f8567425e6d437fc9574c3bd18ffea3c6f98dc95", "type": "Import", "name": "datetime", "module": "datetime", "full_name": "datetime.datetime", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 37, "is_stdlib": true, "is_function_level": false, "scope": "module"}
{"id": "053583e2a7b2c2e04df39eb13740f3fbd14fbce0", "type": "Import", "name": "os", "alias": null, "import_type": "direct", "lineno": 38, "is_stdlib": true, "is_relative": false, "level": 0, "is_function_level": false, "scope": "module"}
{"id": "b3b6a2329ec56fbd2a0ac120dea45e224b8f0387", "type": "Class", "name": "PDFReportGenerator", "lineno": 40, "end_lineno": 147, "docstring": null, "parsed_docstring": {}, "snippet": "class PDFReportGenerator:\n    def __init__(self):\n        self.styles = getSampleStyleSheet()\n        self.title_style = ParagraphStyle(\n            'CustomTitle',\n            parent=self.styles['Heading1'],\n            fontSize=18,\n            spaceAfter=30,\n            alignment=1  # Center alignment\n        )\n...", "full_source_code": "class PDFReportGenerator:\n    def __init__(self):\n        self.styles = getSampleStyleSheet()\n        self.title_style = ParagraphStyle(\n            'CustomTitle',\n            parent=self.styles['Heading1'],\n            fontSize=18,\n            spaceAfter=30,\n            alignment=1  # Center alignment\n        )\n        self.heading_style = ParagraphStyle(\n            'CustomHeading',\n            parent=self.styles['Heading2'],\n            fontSize=14,\n            spaceAfter=12,\n            textColor=colors.darkblue\n        )\n    \n    def generate_pdf_report(self, kpi_data, ai_report, filename=None):\n        if not filename:\n            timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n            filename = f\"{timestamp}_PO_Report.pdf\"\n        \n        doc = SimpleDocTemplate(filename, pagesize=A4)\n        story = []\n        \n        # Title\n        title = Paragraph(\"Purchase Order Performance Report\", self.title_style)\n        story.append(title)\n        story.append(Spacer(1, 20))\n        \n        # Report Date\n        date_text = f\"Report Generated: {datetime.now().strftime('%B %d, %Y at %I:%M %p')}\"\n        story.append(Paragraph(date_text, self.styles['Normal']))\n        story.append(Spacer(1, 20))\n        \n        # KPI Summary Table\n        story.append(Paragraph(\"Key Performance Indicators Summary\", self.heading_style))\n        \n        kpi_table_data = [['KPI Description', 'Current', 'Target', 'Status']]\n        for kpi in kpi_data:\n            kpi_table_data.append([\n                kpi['description'],\n                f\"{kpi['value']}\",\n                f\"{kpi['target']}\",\n                kpi['status']\n            ])\n        \n        kpi_table = Table(kpi_table_data, colWidths=[3.5*inch, 1*inch, 1*inch, 1*inch])\n        kpi_table.setStyle(TableStyle([\n            # Header styling\n            ('BACKGROUND', (0, 0), (-1, 0), colors.darkblue),\n            ('TEXTCOLOR', (0, 0), (-1, 0), colors.white),\n            ('ALIGN', (0, 0), (-1, -1), 'LEFT'),\n            ('ALIGN', (1, 0), (-1, -1), 'CENTER'),\n            ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),\n            ('FONTSIZE', (0, 0), (-1, 0), 11),\n            ('BOTTOMPADDING', (0, 0), (-1, 0), 12),\n            ('TOPPADDING', (0, 0), (-1, 0), 12),\n            \n            # Data rows styling\n            ('BACKGROUND', (0, 1), (-1, -1), colors.white),\n            ('FONTNAME', (0, 1), (-1, -1), 'Helvetica'),\n            ('FONTSIZE', (0, 1), (-1, -1), 10),\n            ('ROWBACKGROUNDS', (0, 1), (-1, -1), [colors.white, colors.lightgrey]),\n            \n            # Grid and padding\n            ('GRID', (0, 0), (-1, -1), 1, colors.black),\n            ('VALIGN', (0, 0), (-1, -1), 'MIDDLE'),\n            ('LEFTPADDING', (0, 0), (-1, -1), 8),\n            ('RIGHTPADDING', (0, 0), (-1, -1), 8),\n            ('TOPPADDING', (0, 1), (-1, -1), 8),\n            ('BOTTOMPADDING', (0, 1), (-1, -1), 8)\n        ]))\n        \n        # Add status-specific coloring\n        for i, kpi in enumerate(kpi_data, 1):\n            if kpi['status'] == 'GOOD':\n                kpi_table.setStyle(TableStyle([('TEXTCOLOR', (3, i), (3, i), colors.green)]))\n            elif kpi['status'] == 'CRITICAL':\n                kpi_table.setStyle(TableStyle([('TEXTCOLOR', (3, i), (3, i), colors.red)]))\n            else:  # WARNING\n                kpi_table.setStyle(TableStyle([('TEXTCOLOR', (3, i), (3, i), colors.orange)]))\n        \n        story.append(kpi_table)\n        story.append(Spacer(1, 30))\n        \n        # AI Analysis\n        story.append(Paragraph(\"AI-Generated Analysis\", self.heading_style))\n        \n        # Split AI report into paragraphs\n        ai_paragraphs = ai_report.split('\\n\\n')\n        for paragraph in ai_paragraphs:\n            if paragraph.strip():\n                # Handle markdown-style headers\n                if paragraph.startswith('**') and paragraph.endswith('**'):\n                    clean_text = paragraph.replace('**', '')\n                    story.append(Paragraph(clean_text, self.heading_style))\n                else:\n                    # Clean up markdown formatting - remove all markdown\n                    clean_text = paragraph.replace('**', '').replace('*', '')\n                    # Remove any HTML-like tags that might cause issues\n                    clean_text = clean_text.replace('<', '&lt;').replace('>', '&gt;')\n                    story.append(Paragraph(clean_text, self.styles['Normal']))\n                story.append(Spacer(1, 12))\n        \n        doc.build(story)\n        return filename", "bases": [], "decorators": [], "num_methods": 2, "num_class_vars": 0, "is_private": false, "is_abstract": false, "embedding_semantics": "Class: PDFReportGenerator | Code:\nclass PDFReportGenerator:\n    def __init__(self):\n        self.styles = getSampleStyleSheet()\n        self.title_style = ParagraphStyle(\n            'CustomTitle',\n            parent=self.styles['Heading1'],\n            fontSize=18,\n            spaceAfter=30,\n            alignment=1  # Center alignment\n        )\n..."}
{"id": "ec40cf7085c5dd1cf016113d3c94347d18195764", "type": "Method", "name": "__init__", "qualified_name": "PDFReportGenerator.__init__", "is_async": false, "is_method": true, "is_static": false, "is_class_method": false, "is_property": false, "is_private": false, "is_magic": true, "decorators": [], "decorator_details": [], "parameters": [{"name": "self", "type": null, "kind": "positional", "default": null, "position": 0}], "return_type": null, "lineno": 41, "end_lineno": 56, "docstring": null, "parsed_docstring": {}, "snippet": "    def __init__(self):\n        self.styles = getSampleStyleSheet()\n        self.title_style = ParagraphStyle(\n            'CustomTitle',\n            parent=self.styles['Heading1'],\n            fontSize=18,\n            spaceAfter=30,\n            alignment=1  # Center alignment\n        )\n        self.heading_style = ParagraphStyle(\n...", "full_source_code": "def __init__(self):\n        self.styles = getSampleStyleSheet()\n        self.title_style = ParagraphStyle(\n            'CustomTitle',\n            parent=self.styles['Heading1'],\n            fontSize=18,\n            spaceAfter=30,\n            alignment=1  # Center alignment\n        )\n        self.heading_style = ParagraphStyle(\n            'CustomHeading',\n            parent=self.styles['Heading2'],\n            fontSize=14,\n            spaceAfter=12,\n            textColor=colors.darkblue\n        )", "metrics": {"lines_of_code": 16, "complexity": 1, "num_parameters": 1, "num_returns": 0, "num_branches": 0, "num_loops": 0, "has_docstring": false, "num_decorators": 0, "max_nesting_depth": 0}, "embedding_semantics": "Method: __init__ | Args: (self) | Code:\n    def __init__(self):\n        self.styles = getSampleStyleSheet()\n        self.title_style = ParagraphStyle(\n            'CustomTitle',\n            parent=self.styles['Heading1'],\n            fontSize=18,\n            spaceAfter=30,\n            alignment=1  # Center alignment\n        )\n        self.heading_style = ParagraphStyle(\n..."}
{"id": "d1bbf83f7b19d837b7aa2426a1cddeea50a32e5f", "type": "Parameter", "name": "self", "param_type": null, "kind": "positional", "default": null, "position": 0}
{"id": "ab0b46fbd8acbd69804976567d5c5b100c774fd8", "type": "Method", "name": "generate_pdf_report", "qualified_name": "PDFReportGenerator.generate_pdf_report", "is_async": false, "is_method": true, "is_static": false, "is_class_method": false, "is_property": false, "is_private": false, "is_magic": false, "decorators": [], "decorator_details": [], "parameters": [{"name": "self", "type": null, "kind": "positional", "default": null, "position": 0}, {"name": "kpi_data", "type": null, "kind": "positional", "default": null, "position": 1}, {"name": "ai_report", "type": null, "kind": "positional", "default": null, "position": 2}, {"name": "filename", "type": null, "kind": "positional", "default": "None", "position": 3}], "return_type": null, "lineno": 58, "end_lineno": 147, "docstring": null, "parsed_docstring": {}, "snippet": "    def generate_pdf_report(self, kpi_data, ai_report, filename=None):\n        if not filename:\n            timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n            filename = f\"{timestamp}_PO_Report.pdf\"\n        \n        doc = SimpleDocTemplate(filename, pagesize=A4)\n        story = []\n        \n        # Title\n        title = Paragraph(\"Purchase Order Performance Report\", self.title_style)\n...", "full_source_code": "def generate_pdf_report(self, kpi_data, ai_report, filename=None):\n        if not filename:\n            timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n            filename = f\"{timestamp}_PO_Report.pdf\"\n        \n        doc = SimpleDocTemplate(filename, pagesize=A4)\n        story = []\n        \n        # Title\n        title = Paragraph(\"Purchase Order Performance Report\", self.title_style)\n        story.append(title)\n        story.append(Spacer(1, 20))\n        \n        # Report Date\n        date_text = f\"Report Generated: {datetime.now().strftime('%B %d, %Y at %I:%M %p')}\"\n        story.append(Paragraph(date_text, self.styles['Normal']))\n        story.append(Spacer(1, 20))\n        \n        # KPI Summary Table\n        story.append(Paragraph(\"Key Performance Indicators Summary\", self.heading_style))\n        \n        kpi_table_data = [['KPI Description', 'Current', 'Target', 'Status']]\n        for kpi in kpi_data:\n            kpi_table_data.append([\n                kpi['description'],\n                f\"{kpi['value']}\",\n                f\"{kpi['target']}\",\n                kpi['status']\n            ])\n        \n        kpi_table = Table(kpi_table_data, colWidths=[3.5*inch, 1*inch, 1*inch, 1*inch])\n        kpi_table.setStyle(TableStyle([\n            # Header styling\n            ('BACKGROUND', (0, 0), (-1, 0), colors.darkblue),\n            ('TEXTCOLOR', (0, 0), (-1, 0), colors.white),\n            ('ALIGN', (0, 0), (-1, -1), 'LEFT'),\n            ('ALIGN', (1, 0), (-1, -1), 'CENTER'),\n            ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),\n            ('FONTSIZE', (0, 0), (-1, 0), 11),\n            ('BOTTOMPADDING', (0, 0), (-1, 0), 12),\n            ('TOPPADDING', (0, 0), (-1, 0), 12),\n            \n            # Data rows styling\n            ('BACKGROUND', (0, 1), (-1, -1), colors.white),\n            ('FONTNAME', (0, 1), (-1, -1), 'Helvetica'),\n            ('FONTSIZE', (0, 1), (-1, -1), 10),\n            ('ROWBACKGROUNDS', (0, 1), (-1, -1), [colors.white, colors.lightgrey]),\n            \n            # Grid and padding\n            ('GRID', (0, 0), (-1, -1), 1, colors.black),\n            ('VALIGN', (0, 0), (-1, -1), 'MIDDLE'),\n            ('LEFTPADDING', (0, 0), (-1, -1), 8),\n            ('RIGHTPADDING', (0, 0), (-1, -1), 8),\n            ('TOPPADDING', (0, 1), (-1, -1), 8),\n            ('BOTTOMPADDING', (0, 1), (-1, -1), 8)\n        ]))\n        \n        # Add status-specific coloring\n        for i, kpi in enumerate(kpi_data, 1):\n            if kpi['status'] == 'GOOD':\n                kpi_table.setStyle(TableStyle([('TEXTCOLOR', (3, i), (3, i), colors.green)]))\n            elif kpi['status'] == 'CRITICAL':\n                kpi_table.setStyle(TableStyle([('TEXTCOLOR', (3, i), (3, i), colors.red)]))\n            else:  # WARNING\n                kpi_table.setStyle(TableStyle([('TEXTCOLOR', (3, i), (3, i), colors.orange)]))\n        \n        story.append(kpi_table)\n        story.append(Spacer(1, 30))\n        \n        # AI Analysis\n        story.append(Paragraph(\"AI-Generated Analysis\", self.heading_style))\n        \n        # Split AI report into paragraphs\n        ai_paragraphs = ai_report.split('\\n\\n')\n        for paragraph in ai_paragraphs:\n            if paragraph.strip():\n                # Handle markdown-style headers\n                if paragraph.startswith('**') and paragraph.endswith('**'):\n                    clean_text = paragraph.replace('**', '')\n                    story.append(Paragraph(clean_text, self.heading_style))\n                else:\n                    # Clean up markdown formatting - remove all markdown\n                    clean_text = paragraph.replace('**', '').replace('*', '')\n                    # Remove any HTML-like tags that might cause issues\n                    clean_text = clean_text.replace('<', '&lt;').replace('>', '&gt;')\n                    story.append(Paragraph(clean_text, self.styles['Normal']))\n                story.append(Spacer(1, 12))\n        \n        doc.build(story)\n        return filename", "metrics": {"lines_of_code": 90, "complexity": 11, "num_parameters": 4, "num_returns": 1, "num_branches": 5, "num_loops": 3, "has_docstring": false, "num_decorators": 0, "max_nesting_depth": 3}, "embedding_semantics": "Method: generate_pdf_report | Args: (self, kpi_data, ai_report, filename) | Code:\n    def generate_pdf_report(self, kpi_data, ai_report, filename=None):\n        if not filename:\n            timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n            filename = f\"{timestamp}_PO_Report.pdf\"\n        \n        doc = SimpleDocTemplate(filename, pagesize=A4)\n        story = []\n        \n        # Title\n        title = Paragraph(\"Purchase Order Performance Report\", self.title_style)\n..."}
{"id": "a44e1fbb12ec4ede5154c18b41cf4d2d7449807f", "type": "Parameter", "name": "self", "param_type": null, "kind": "positional", "default": null, "position": 0}
{"id": "522acbfdef07e68ab494a830cae7b6bd35c5498c", "type": "Parameter", "name": "kpi_data", "param_type": null, "kind": "positional", "default": null, "position": 1}
{"id": "b09a9675b58b4a73f7fa1853cd72ef63e3955955", "type": "Parameter", "name": "ai_report", "param_type": null, "kind": "positional", "default": null, "position": 2}
{"id": "930880b23ac36173d7b72d19c662cfdbfd5805fd", "type": "Parameter", "name": "filename", "param_type": null, "kind": "positional", "default": "None", "position": 3}
{"id": "cd5c88a3c94eea1ec7aa5d09cb0385261a2b8103", "type": "Variable", "name": "timestamp", "value": "datetime.now().strftime('%Y%m%d_%H%M%S')", "value_type": "complex", "lineno": 60, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "da1f9a6d9e769e862842a8e307c88a8d0ecba9c1", "type": "Variable", "name": "filename", "value": "f'{timestamp}_PO_Report.pdf'", "value_type": "complex", "lineno": 61, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "48a5463e483bb982c5570d45e8f97db913b7ac1a", "type": "Variable", "name": "doc", "value": "SimpleDocTemplate(filename, pagesize=A4)", "value_type": "complex", "lineno": 63, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "20b5cc8756dce1e414f38b24ba30996ab43b346b", "type": "Variable", "name": "story", "value": "[]", "value_type": "complex", "lineno": 64, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "61be6e75135e027d616c5d63e5cba87b58b32a2f", "type": "Variable", "name": "title", "value": "Paragraph('Purchase Order Performance Report', self.title_style)", "value_type": "complex", "lineno": 67, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "66f95be31fb4584e6fb36e4df76302cbdbf0e9d0", "type": "Variable", "name": "date_text", "value": "f\"Report Generated: {datetime.now().strftime('%B %d, %Y at %I:%M %p')}\"", "value_type": "complex", "lineno": 72, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "5693f408b0f8f55aa0a731ae8ad4b2c586c3d36c", "type": "Variable", "name": "kpi_table_data", "value": "[['KPI Description', 'Current', 'Target', 'Status']]", "value_type": "complex", "lineno": 79, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "7ef40a3e12f1e2b8abc22aa112c8d2df692c78c8", "type": "Variable", "name": "kpi_table", "value": "Table(kpi_table_data, colWidths=[3.5 * inch, 1 * inch, 1 * inch, 1 * inch])", "value_type": "complex", "lineno": 88, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "2fbc8440896e12c3ef1517edfc4342050a3b88cd", "type": "Variable", "name": "ai_paragraphs", "value": "ai_report.split('\\n\\n')", "value_type": "complex", "lineno": 131, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "76cbcf95ab9e3d402be7c48ec2e6c0b0829239d7", "type": "Variable", "name": "clean_text", "value": "paragraph.replace('**', '')", "value_type": "complex", "lineno": 136, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "7d9e38f23c876254ae8da1298838680f11253f4d", "type": "Variable", "name": "clean_text", "value": "paragraph.replace('**', '').replace('*', '')", "value_type": "complex", "lineno": 140, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "4c2d6fb6cb7922906c8c7ec81e84aa8a4da1bff5", "type": "Variable", "name": "clean_text", "value": "clean_text.replace('<', '&lt;').replace('>', '&gt;')", "value_type": "complex", "lineno": 142, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "5a3994f2be45ef9d66bc9cf42b1e1e2aa25ff679", "type": "File", "name": "main.py", "path": "/home/sahil/Workspace/Source Wall/Simple_Financial_Agent/main.py", "relpath": "main.py", "module": "main", "extension": ".py", "sha1": "c7e3af2628575c62e08cd20d3dc89710c3882a55", "lines_of_code": 45, "source_code": "import os\nfrom dotenv import load_dotenv\nfrom financial_agent import FinancialReportAgent\n\ndef main():\n    # Load environment variables from .env file\n    load_dotenv()\n    \n    # Set your Groq API key\n    groq_api_key = os.getenv('GROQ_API_KEY')\n    if not groq_api_key:\n        print(\"Please set GROQ_API_KEY environment variable\")\n        return\n    \n    # Initialize the agent\n    agent = FinancialReportAgent('po_config.yaml', groq_api_key)\n    \n    # Generate report\n    print(\"Generating Financial Report...\")\n    report, pdf_filename = agent.generate_pdf_report()\n    \n    # Save text report\n    with open('financial_report.txt', 'w') as f:\n        f.write(report)\n    \n    print(f\"Reports generated successfully!\")\n    print(f\"Text report: financial_report.txt\")\n    print(f\"PDF report: {pdf_filename}\")\n    print(\"\\n\" + \"=\"*50)\n    print(\"EXECUTIVE SUMMARY:\")\n    print(\"=\"*50)\n    \n    # Display summary of KPIs\n    kpis = agent.db_manager.calculate_kpis()\n    for kpi_name, value in kpis.items():\n        status = agent.get_kpi_status(kpi_name, value)\n        target = agent.config['kpis'][kpi_name]['target']\n        description = agent.config['kpis'][kpi_name]['description']\n        print(f\"{description}: {value:.1f} (Target: {target}) - {status}\")\n    \n    print(\"\\n\" + \"=\"*50)\n    print(\"Full AI analysis available in the PDF report.\")\n\nif __name__ == \"__main__\":\n    main()", "size_bytes": 1392, "language": "python", "encoding": "utf-8", "embedding_semantics": "File: main.py | Module: main"}
{"id": "a36c7ee038c250dfeadbbeb9ebc63ec9e5f51781", "type": "Import", "name": "os", "alias": null, "import_type": "direct", "lineno": 1, "is_stdlib": true, "is_relative": false, "level": 0, "is_function_level": false, "scope": "module"}
{"id": "751587eb18ae09e3f1f43bb21b78bd63a592a471", "type": "Import", "name": "load_dotenv", "module": "dotenv", "full_name": "dotenv.load_dotenv", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 2, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "5d1c413c4dd4432b23afff66c728729c2b9e98ab", "type": "Import", "name": "FinancialReportAgent", "module": "financial_agent", "full_name": "financial_agent.FinancialReportAgent", "alias": null, "import_type": "from", "level": 0, "is_relative": false, "lineno": 3, "is_stdlib": false, "is_function_level": false, "scope": "module"}
{"id": "f0459b46793c31f920902f738c0f35208ad7feaa", "type": "Function", "name": "main", "qualified_name": "main", "is_async": false, "is_method": false, "is_static": false, "is_class_method": false, "is_property": false, "is_private": false, "is_magic": false, "decorators": [], "decorator_details": [], "parameters": [], "return_type": null, "lineno": 5, "end_lineno": 42, "docstring": null, "parsed_docstring": {}, "snippet": "def main():\n    # Load environment variables from .env file\n    load_dotenv()\n    \n    # Set your Groq API key\n    groq_api_key = os.getenv('GROQ_API_KEY')\n    if not groq_api_key:\n        print(\"Please set GROQ_API_KEY environment variable\")\n        return\n    \n...", "full_source_code": "def main():\n    # Load environment variables from .env file\n    load_dotenv()\n    \n    # Set your Groq API key\n    groq_api_key = os.getenv('GROQ_API_KEY')\n    if not groq_api_key:\n        print(\"Please set GROQ_API_KEY environment variable\")\n        return\n    \n    # Initialize the agent\n    agent = FinancialReportAgent('po_config.yaml', groq_api_key)\n    \n    # Generate report\n    print(\"Generating Financial Report...\")\n    report, pdf_filename = agent.generate_pdf_report()\n    \n    # Save text report\n    with open('financial_report.txt', 'w') as f:\n        f.write(report)\n    \n    print(f\"Reports generated successfully!\")\n    print(f\"Text report: financial_report.txt\")\n    print(f\"PDF report: {pdf_filename}\")\n    print(\"\\n\" + \"=\"*50)\n    print(\"EXECUTIVE SUMMARY:\")\n    print(\"=\"*50)\n    \n    # Display summary of KPIs\n    kpis = agent.db_manager.calculate_kpis()\n    for kpi_name, value in kpis.items():\n        status = agent.get_kpi_status(kpi_name, value)\n        target = agent.config['kpis'][kpi_name]['target']\n        description = agent.config['kpis'][kpi_name]['description']\n        print(f\"{description}: {value:.1f} (Target: {target}) - {status}\")\n    \n    print(\"\\n\" + \"=\"*50)\n    print(\"Full AI analysis available in the PDF report.\")", "metrics": {"lines_of_code": 38, "complexity": 4, "num_parameters": 0, "num_returns": 1, "num_branches": 1, "num_loops": 1, "has_docstring": false, "num_decorators": 0, "max_nesting_depth": 1}, "embedding_semantics": "Function: main | Code:\ndef main():\n    # Load environment variables from .env file\n    load_dotenv()\n    \n    # Set your Groq API key\n    groq_api_key = os.getenv('GROQ_API_KEY')\n    if not groq_api_key:\n        print(\"Please set GROQ_API_KEY environment variable\")\n        return\n    \n..."}
{"id": "632e9a4d34e93a2f19389a57c8f57c741a781c8f", "type": "Variable", "name": "groq_api_key", "value": "os.getenv('GROQ_API_KEY')", "value_type": "complex", "lineno": 10, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "9965744c932024fc5ebada20498dc9a08dff1e26", "type": "Variable", "name": "agent", "value": "FinancialReportAgent('po_config.yaml', groq_api_key)", "value_type": "complex", "lineno": 16, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "cc70d0d31c05a07b57d353e5260d8437db6ffc20", "type": "Variable", "name": "kpis", "value": "agent.db_manager.calculate_kpis()", "value_type": "complex", "lineno": 34, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "e2e8a17f959876259497fbbb50e92c5aa7ff115c", "type": "Variable", "name": "status", "value": "agent.get_kpi_status(kpi_name, value)", "value_type": "complex", "lineno": 36, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "592e4e99f08d3f2d208b0ca3733bb3acf277415d", "type": "Variable", "name": "target", "value": "agent.config['kpis'][kpi_name]['target']", "value_type": "complex", "lineno": 37, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "106b4b150a9a7a6071c4779faff8db320f30090d", "type": "Variable", "name": "description", "value": "agent.config['kpis'][kpi_name]['description']", "value_type": "complex", "lineno": 38, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "1f20ffbb8a11794c7d240c12efac426b890b3008", "type": "File", "name": "setup_database.py", "path": "/home/sahil/Workspace/Source Wall/Simple_Financial_Agent/setup_database.py", "relpath": "setup_database.py", "module": "setup_database", "extension": ".py", "sha1": "5456b8eff16425de7ab624e893a73c136fdb90cc", "lines_of_code": 45, "source_code": "'''\nDatabase Initialization Script\n------------------------------\n\nThis script initializes a local SQLite database (`purchase_orders.db`) using \ndata from two existing CSV files: `purchase_orders.csv` and `line_items.csv`.\n\nCore Responsibilities:\n- Load purchase order and line item data from CSV files\n- Create or replace corresponding tables in a SQLite database\n- Provide quick verification of loaded records\n\nStructure:\n- `create_database()`: Reads CSVs and populates database tables\n- Command-line execution supported via `__main__` entry point\n\nUsage:\n    $ python create_database.py\n\nOutput:\n    Database created successfully from existing CSV files!\n    Loaded <X> purchase orders\n    Loaded <Y> line items\n'''\n\n\nimport sqlite3\nimport pandas as pd\n\ndef create_database():\n    # Read existing CSV files\n    purchase_orders_df = pd.read_csv('purchase_orders.csv')\n    line_items_df = pd.read_csv('line_items.csv')\n    \n    # Create SQLite database using existing data\n    with sqlite3.connect('purchase_orders.db') as conn:\n        purchase_orders_df.to_sql('purchase_orders', conn, if_exists='replace', index=False)\n        line_items_df.to_sql('line_items', conn, if_exists='replace', index=False)\n    \n    print(\"Database created successfully from existing CSV files!\")\n    print(f\"Loaded {len(purchase_orders_df)} purchase orders\")\n    print(f\"Loaded {len(line_items_df)} line items\")\n\nif __name__ == \"__main__\":\n    create_database()", "size_bytes": 1444, "language": "python", "encoding": "utf-8", "embedding_semantics": "File: setup_database.py | Module: setup_database | Documentation:\nDatabase Initialization Script\n------------------------------\n\nThis script initializes a local SQLite database (`purchase_orders.db`) using \ndata from two existing CSV files: `purchase_orders.csv` and `line_items.csv`.\n\nCore Responsibilities:\n- Load purchase order and line item data from CSV files\n- Create or replace corresponding tables in a SQLite database\n- Provide quick verification of loaded records\n\nStructure:\n- `create_database()`: Reads CSVs and populates database tables\n- Command-line execution supported via `__main__` entry point\n\nUsage:\n    $ python create_database.py\n\nOutput:\n    Database created successfully from existing CSV files!\n    Loaded <X> purchase orders\n    Loaded <Y> line items"}
{"id": "ff465bb89ef91df16049ad5ae5b91ecabe9d6845", "type": "Import", "name": "sqlite3", "alias": null, "import_type": "direct", "lineno": 27, "is_stdlib": false, "is_relative": false, "level": 0, "is_function_level": false, "scope": "module"}
{"id": "318c4eaa58164ecf55a5c91bd021fab090c3ec4e", "type": "Import", "name": "pandas", "alias": "pd", "import_type": "direct", "lineno": 28, "is_stdlib": false, "is_relative": false, "level": 0, "is_function_level": false, "scope": "module"}
{"id": "a8ef5f353257696aaa56d8170d1cb444ccb99327", "type": "Function", "name": "create_database", "qualified_name": "create_database", "is_async": false, "is_method": false, "is_static": false, "is_class_method": false, "is_property": false, "is_private": false, "is_magic": false, "decorators": [], "decorator_details": [], "parameters": [], "return_type": null, "lineno": 30, "end_lineno": 42, "docstring": null, "parsed_docstring": {}, "snippet": "def create_database():\n    # Read existing CSV files\n    purchase_orders_df = pd.read_csv('purchase_orders.csv')\n    line_items_df = pd.read_csv('line_items.csv')\n    \n    # Create SQLite database using existing data\n    with sqlite3.connect('purchase_orders.db') as conn:\n        purchase_orders_df.to_sql('purchase_orders', conn, if_exists='replace', index=False)\n        line_items_df.to_sql('line_items', conn, if_exists='replace', index=False)\n    \n...", "full_source_code": "def create_database():\n    # Read existing CSV files\n    purchase_orders_df = pd.read_csv('purchase_orders.csv')\n    line_items_df = pd.read_csv('line_items.csv')\n    \n    # Create SQLite database using existing data\n    with sqlite3.connect('purchase_orders.db') as conn:\n        purchase_orders_df.to_sql('purchase_orders', conn, if_exists='replace', index=False)\n        line_items_df.to_sql('line_items', conn, if_exists='replace', index=False)\n    \n    print(\"Database created successfully from existing CSV files!\")\n    print(f\"Loaded {len(purchase_orders_df)} purchase orders\")\n    print(f\"Loaded {len(line_items_df)} line items\")", "metrics": {"lines_of_code": 13, "complexity": 2, "num_parameters": 0, "num_returns": 0, "num_branches": 0, "num_loops": 0, "has_docstring": false, "num_decorators": 0, "max_nesting_depth": 1}, "embedding_semantics": "Function: create_database | Code:\ndef create_database():\n    # Read existing CSV files\n    purchase_orders_df = pd.read_csv('purchase_orders.csv')\n    line_items_df = pd.read_csv('line_items.csv')\n    \n    # Create SQLite database using existing data\n    with sqlite3.connect('purchase_orders.db') as conn:\n        purchase_orders_df.to_sql('purchase_orders', conn, if_exists='replace', index=False)\n        line_items_df.to_sql('line_items', conn, if_exists='replace', index=False)\n    \n..."}
{"id": "5736e0f06159d38b0949946a3441374ecda164fb", "type": "Variable", "name": "purchase_orders_df", "value": "pd.read_csv('purchase_orders.csv')", "value_type": "complex", "lineno": 32, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
{"id": "752500e677d61b7e0c85a06a8fe8ac99a02da746", "type": "Variable", "name": "line_items_df", "value": "pd.read_csv('line_items.csv')", "value_type": "complex", "lineno": 33, "is_global": false, "is_constant": false, "is_private": false, "scope": "local"}
